{
	"name": "esGame",
	"events": [
		{
			"eventType": "variable",
			"name": "gameSTATE",
			"type": "string",
			"initialValue": "\"Waiting\"",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 364612918488566
		},
		{
			"eventType": "variable",
			"name": "playerPosition",
			"type": "number",
			"initialValue": "0",
			"comment": "Posição de player de acordo com a ordem de chegada na sala",
			"isStatic": false,
			"isConstant": false,
			"sid": 423694782249212
		},
		{
			"eventType": "variable",
			"name": "listOrderPlayers",
			"type": "string",
			"initialValue": "",
			"comment": "Ordem de turno no jogo",
			"isStatic": false,
			"isConstant": false,
			"sid": 515345974243659
		},
		{
			"eventType": "variable",
			"name": "canPlay",
			"type": "boolean",
			"initialValue": "false",
			"comment": "Se pode jogar",
			"isStatic": false,
			"isConstant": false,
			"sid": 877812659621795
		},
		{
			"eventType": "include",
			"includeSheet": "esFunctions"
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "SIGNALLING",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 710372152494421
						}
					],
					"actions": [
						{
							"id": "connect",
							"objectClass": "Multiplayer",
							"sid": 572526911390403,
							"parameters": {
								"server": "\"wss://multiplayer.scirra.com\""
							}
						},
						{
							"callFunction": "deliverPieces",
							"sid": 616359635118083,
							"disabled": true,
							"parameters": [
								"\"\""
							]
						}
					],
					"sid": 304672748930915
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-connected",
							"objectClass": "Multiplayer",
							"sid": 115367796650639
						}
					],
					"actions": [
						{
							"id": "log-in",
							"objectClass": "Multiplayer",
							"sid": 970300480285904,
							"parameters": {
								"alias": "ALIAS"
							}
						}
					],
					"sid": 189992680996563
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-logged-in",
							"objectClass": "Multiplayer",
							"sid": 324689558803383
						}
					],
					"actions": [
						{
							"id": "auto-join-room",
							"objectClass": "Multiplayer",
							"sid": 944104059167616,
							"parameters": {
								"game": "GAME_INSTANCE",
								"instance": "NAME_INSTANCE",
								"first-room": "ROOM_NAME",
								"max-peers": "4",
								"locking": "lock-when-full"
							}
						}
					],
					"sid": 737787568321539
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-joined-room",
							"objectClass": "Multiplayer",
							"sid": 625785078588996
						}
					],
					"actions": [],
					"sid": 151028646529962,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-host",
									"objectClass": "Multiplayer",
									"sid": 856928222696143
								}
							],
							"actions": [
								{
									"callFunction": "deliverPieces",
									"sid": 166990258330274,
									"parameters": [
										"\"HOST\""
									]
								},
								{
									"id": "set-group-active",
									"objectClass": "System",
									"sid": 306188866038752,
									"parameters": {
										"group-name": "\"HOST\"",
										"state": "activated"
									}
								},
								{
									"callFunction": "CallLog",
									"sid": 529636763541970,
									"parameters": [
										"\"success\"",
										"\"HOST\" & newline & \"Número de jogadores na sala: 1\""
									]
								}
							],
							"sid": 485733222983461
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 617715325985704
								}
							],
							"actions": [
								{
									"id": "set-group-active",
									"objectClass": "System",
									"sid": 494796062275140,
									"parameters": {
										"group-name": "\"PEER\"",
										"state": "activated"
									}
								},
								{
									"callFunction": "CallLog",
									"sid": 110955656809382,
									"parameters": [
										"\"success\"",
										"\"PEER\" & newline & \"Esperando por jogadores\""
									]
								}
							],
							"sid": 394234097735773
						}
					]
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-error",
							"objectClass": "Multiplayer",
							"sid": 759755412379476
						}
					],
					"actions": [
						{
							"id": "disconnect-signalling",
							"objectClass": "Multiplayer",
							"sid": 635737905323206
						},
						{
							"callFunction": "CallLog",
							"sid": 150608871356931,
							"parameters": [
								"\"error\"",
								"\"Houve um erro, você foi desconectado\""
							]
						},
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 696007837310871,
							"parameters": {
								"seconds": "1.5"
							}
						},
						{
							"id": "go-to-layout",
							"objectClass": "System",
							"sid": 448576515063928,
							"parameters": {
								"layout": "Menu"
							}
						}
					],
					"sid": 413776618437760
				}
			],
			"sid": 260201199567679
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "HOST",
			"description": "",
			"isActiveOnStart": false,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-peer-connected",
							"objectClass": "Multiplayer",
							"sid": 291823386776715
						}
					],
					"actions": [
						{
							"callFunction": "CallLog",
							"sid": 642196473560205,
							"parameters": [
								"\"success\"",
								"\"HOST\" & newline & \"Número de jogadores na sala: \" & Multiplayer.PeerCount"
							]
						},
						{
							"type": "comment",
							"text": "Passando posição para jogador que entrou"
						},
						{
							"id": "send-message",
							"objectClass": "Multiplayer",
							"sid": 595722890336271,
							"parameters": {
								"peer-id": "Multiplayer.PeerID",
								"tag": "\"position\"",
								"message": "str(Multiplayer.PeerCount)",
								"mode": "reliable-ordered"
							}
						},
						{
							"type": "comment",
							"text": "Adicionando nick do jogador ao jogo local do host"
						},
						{
							"callFunction": "callLayout",
							"sid": 324897030775276,
							"parameters": [
								"Multiplayer.PeerID",
								"Multiplayer.PeerAlias"
							]
						},
						{
							"type": "comment",
							"text": "Entregar peça para peer"
						},
						{
							"callFunction": "deliverPieces",
							"sid": 247452457017704,
							"parameters": [
								"Multiplayer.PeerID"
							]
						}
					],
					"sid": 918152890183309,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-peer-count",
									"objectClass": "Multiplayer",
									"sid": 209184416991520,
									"parameters": {
										"comparison": 0,
										"count": "4"
									}
								}
							],
							"actions": [
								{
									"callFunction": "startGameHOST",
									"sid": 348323465076430
								}
							],
							"sid": 675204702590750
						}
					]
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-peer-message",
							"objectClass": "Multiplayer",
							"sid": 411587276576103,
							"parameters": {
								"tag": "\"Played\""
							}
						}
					],
					"actions": [
						{
							"callFunction": "playTurn",
							"sid": 473505526724765
						}
					],
					"sid": 505088219912776
				}
			],
			"sid": 980703102073303
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "PEER",
			"description": "",
			"isActiveOnStart": false,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-peer-message",
							"objectClass": "Multiplayer",
							"sid": 456441499462730,
							"parameters": {
								"tag": "\"log\""
							}
						}
					],
					"actions": [
						{
							"callFunction": "CallLog",
							"sid": 459991959522539,
							"parameters": [
								"\"success\"",
								"Multiplayer.Message"
							]
						}
					],
					"sid": 908580429077183
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-peer-message",
							"objectClass": "Multiplayer",
							"sid": 445417186992205,
							"parameters": {
								"tag": "\"gameState\""
							}
						}
					],
					"actions": [
						{
							"callFunction": "changeGameState",
							"sid": 989146545164789,
							"parameters": [
								"Multiplayer.Message"
							]
						}
					],
					"sid": 916554284443167
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-peer-message",
							"objectClass": "Multiplayer",
							"sid": 864439985878875,
							"parameters": {
								"tag": "\"position\""
							}
						}
					],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 206117194846860,
							"parameters": {
								"variable": "playerPosition",
								"value": "int(Multiplayer.Message)"
							}
						}
					],
					"sid": 714430947320853
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-peer-message",
							"objectClass": "Multiplayer",
							"sid": 211804355599198,
							"parameters": {
								"tag": "\"newPieces\""
							}
						}
					],
					"actions": [
						{
							"callFunction": "recievePieces",
							"sid": 407492637362786,
							"parameters": [
								"Multiplayer.Message"
							]
						},
						{
							"callFunction": "CallLog",
							"sid": 321711440303559,
							"parameters": [
								"\"warn\"",
								"Multiplayer.Message"
							]
						}
					],
					"sid": 556244373464115
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-peer-message",
							"objectClass": "Multiplayer",
							"sid": 339605981080145,
							"parameters": {
								"tag": "\"startGame\""
							}
						}
					],
					"actions": [
						{
							"callFunction": "callLayout",
							"sid": 438463165374280,
							"parameters": [
								"Multiplayer.Message",
								"str(playerPosition)"
							]
						},
						{
							"id": "set-visible",
							"objectClass": "myPieces",
							"sid": 628047682874180,
							"parameters": {
								"visibility": "visible"
							}
						}
					],
					"sid": 239649513223726
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-peer-message",
							"objectClass": "Multiplayer",
							"sid": 510303656747083,
							"parameters": {
								"tag": "\"Play\""
							}
						}
					],
					"actions": [
						{
							"callFunction": "Play",
							"sid": 269559449471867
						}
					],
					"sid": 187345268352247
				}
			],
			"sid": 566656446511828
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Common",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"functionName": "Play",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionIsAsync": false,
					"functionParameters": [],
					"eventType": "function-block",
					"conditions": [],
					"actions": [
						{
							"id": "set-boolean-eventvar",
							"objectClass": "System",
							"sid": 625932364555265,
							"parameters": {
								"variable": "canPlay",
								"value": "true"
							}
						},
						{
							"id": "set-enabled",
							"objectClass": "myPieces",
							"sid": 377946206185852,
							"behaviorType": "DragDrop",
							"parameters": {
								"state": "enabled"
							}
						}
					],
					"sid": 427178602646086
				},
				{
					"eventType": "comment",
					"text": "pieces"
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "has-los-to-object",
							"objectClass": "myPieces",
							"sid": 712941587308634,
							"behaviorType": "LineOfSight",
							"parameters": {
								"object": "newPiece",
								"image-point": "0"
							}
						},
						{
							"id": "compare-animation-frame",
							"objectClass": "myPieces",
							"sid": 781616213024638,
							"parameters": {
								"comparison": 0,
								"number": "27"
							}
						}
					],
					"actions": [
						{
							"callFunction": "CallLog",
							"sid": 269491212400392,
							"parameters": [
								"\"\"",
								"\"Tem visão\""
							]
						},
						{
							"id": "set-size",
							"objectClass": "myPieces",
							"sid": 868581888890868,
							"parameters": {
								"width": "lerp(myPieces.Width, newPiece.Width, (dt*5))",
								"height": "lerp(myPieces.Height, newPiece.Height, (dt*5))"
							}
						},
						{
							"id": "set-position",
							"objectClass": "myPieces",
							"sid": 228025824827866,
							"parameters": {
								"x": "lerp(myPieces.X, newPiece.X, (dt * 7))",
								"y": "lerp(myPieces.Y, newPiece.Y, (dt * 7))"
							}
						}
					],
					"sid": 728023899788253,
					"children": [
						{
							"eventType": "block",
							"conditions": [],
							"actions": [],
							"sid": 981251519726410
						}
					]
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 753017250447026
						}
					],
					"actions": [
						{
							"id": "set-size",
							"objectClass": "myPieces",
							"sid": 657513939632850,
							"parameters": {
								"width": "lerp(myPieces.Width, 178, (dt*5))",
								"height": "lerp(myPieces.Height, 312, (dt*5))"
							}
						}
					],
					"sid": 563342592871761
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-drag-start",
							"objectClass": "myPieces",
							"sid": 307869823278423,
							"behaviorType": "DragDrop"
						}
					],
					"actions": [],
					"sid": 713237910916858,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-animation-frame",
									"objectClass": "myPieces",
									"sid": 259556358915097,
									"parameters": {
										"comparison": 0,
										"number": "27"
									}
								}
							],
							"actions": [
								{
									"id": "set-visible",
									"objectClass": "newPiece",
									"sid": 480686915065796,
									"parameters": {
										"visibility": "visible"
									}
								},
								{
									"id": "tween-one-property",
									"objectClass": "newPiece",
									"sid": 290699261613063,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"opacityAnim\"",
										"property": "offsetOpacity",
										"end-value": "15",
										"time": "1.5",
										"ease": "default",
										"destroy-on-complete": "no",
										"loop": "yes",
										"ping-pong": "yes"
									}
								}
							],
							"sid": 499387214041309
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 431543701764737
								}
							],
							"actions": [
								{
									"id": "set-visible",
									"objectClass": "newPiece",
									"sid": 225343497252791,
									"parameters": {
										"visibility": "invisible"
									}
								}
							],
							"sid": 151075349738861
						}
					]
				},
				{
					"eventType": "comment",
					"text": "logs controllers"
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-key-pressed",
							"objectClass": "Keyboard",
							"sid": 669867169372596,
							"parameters": {
								"key": 76
							}
						}
					],
					"actions": [],
					"sid": 108941777487132,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-boolean-eventvar",
									"objectClass": "System",
									"sid": 941345735964265,
									"parameters": {
										"variable": "canPlay"
									}
								}
							],
							"actions": [
								{
									"id": "set-boolean-eventvar",
									"objectClass": "System",
									"sid": 423807770340610,
									"parameters": {
										"variable": "canPlay",
										"value": "false"
									}
								}
							],
							"sid": 261143839799564,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-host",
											"objectClass": "Multiplayer",
											"sid": 674452864284983
										}
									],
									"actions": [
										{
											"callFunction": "playTurn",
											"sid": 736659439960623
										}
									],
									"sid": 573862591189466
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 228827823676023
										}
									],
									"actions": [
										{
											"id": "send-message",
											"objectClass": "Multiplayer",
											"sid": 870334151860340,
											"parameters": {
												"peer-id": "\"\"",
												"tag": "\"Played\"",
												"message": "Multiplayer.MyID",
												"mode": "reliable-ordered"
											}
										}
									],
									"sid": 516909349938522
								}
							]
						}
					]
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-key-pressed",
							"objectClass": "Keyboard",
							"sid": 880604354903547,
							"parameters": {
								"key": 72
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Aparecer / Apagar log"
						},
						{
							"id": "set-visible",
							"objectClass": "project_description",
							"sid": 201035474890568,
							"parameters": {
								"visibility": "toggle"
							}
						}
					],
					"sid": 532592001699230
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-key-pressed",
							"objectClass": "Keyboard",
							"sid": 188760436061501,
							"parameters": {
								"key": 75
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Hackar início do jogo"
						},
						{
							"callFunction": "recievePieces",
							"sid": 597545341991441,
							"parameters": [
								"\"27;0;1;2;3;4;5;\""
							]
						},
						{
							"id": "set-visible",
							"objectClass": "myPieces",
							"sid": 805810778787520,
							"parameters": {
								"visibility": "visible"
							}
						},
						{
							"callFunction": "Play",
							"sid": 737473045242769
						}
					],
					"sid": 663053953942454
				}
			],
			"sid": 354476756913533
		}
	],
	"sid": 979608044117383
}